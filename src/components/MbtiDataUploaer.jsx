import React, { useState } from 'react';
import { db } from '../firebaseConfig.js';
import { collection, doc, setDoc, writeBatch } from 'firebase/firestore';

export const questions = [
  {
    id: 1,
    question: "여행지에서의 아침이 밝았다! 나의 첫 행동은?",
    options: [
      { text: "계획표를 확인하고 첫 번째 장소로 바로 출발!", type: 'P' },
      { text: "창밖을 보며 커피 한잔... 오늘 뭐 할지는 천천히 생각한다.", type: 'J' }
    ]
  },
  {
    id: 2,
    question: "점심 메뉴를 고를 시간! 나의 선택은?",
    options: [
      { text: "SNS에서 가장 유명한 맛집! 웨이팅이 있어도 괜찮아.", type: 'S' },
      { text: "발길 닿는 대로 걷다가 끌리는 식당으로 들어간다.", type: 'U' }
    ]
  },
  {
    id: 3,
    question: "기념품 가게에서 마음에 쏙 드는 물건을 발견했다. 하지만...",
    options: [
      { text: "예산을 초과하네. 아쉽지만 사진만 찍고 돌아선다.", type: 'C' },
      { text: "이건 여기서만 살 수 있어! 망설임 없이 구매한다.", type: 'E' }
    ]
  },
  {
    id: 4,
    question: "오후 일정을 소화하는 나의 모습은?",
    options: [
      { text: "하나라도 더 봐야지! 박물관 찍고, 전망대까지 클리어!", type: 'A' },
      { text: "예쁜 카페에 앉아 여유롭게 디저트를 즐기며 쉰다.", type: 'R' }
    ]
  },
  {
    id: 5,
    question: "길을 걷다 우연히 '숨겨진 명소' 표지판을 발견했다!",
    options: [
      { text: "오! 이런 게 진짜 여행이지! 당장 들어가 본다.", type: 'U' },
      { text: "여긴 꼭 가봐야 해! SNS에서 본 그 유명한 포토존으로 간다.", type: 'S' }
    ]
  },
  {
    id: 6,
    question: "여행지에서 특별한 체험 액티비티(패러글라이딩 등)를 발견했다.",
    options: [
      { text: "이런 기회는 놓칠 수 없지! 바로 예약한다.", type: 'E' },
      { text: "가격이 만만치 않네. 그 돈으로 맛있는 거 세 번 더 사 먹는다.", type: 'C' }
    ]
  },
  {
    id: 7,
    question: "여행 중 가장 기분이 좋을 때는?",
    options: [
      { text: "아무도 없는 해변에 앉아 파도 소리를 들을 때.", type: 'R' },
      { text: "새로운 스포츠를 배우거나, 하이킹 정상에 올랐을 때.", type: 'A' }
    ]
  },
  {
    id: 8,
    question: "여행 계획을 세울 때 나의 모습은?",
    options: [
      { text: "숙소와 비행기만 예약하고 나머지는 현지에서 결정한다.", type: 'J' },
      { text: "맛집 동선과 이동 시간까지 분 단위로 계획한다.", type: 'P' }
    ]
  },
  {
    id: 9,
    question: "숙소를 고르는 가장 중요한 기준은?",
    options: [
      { text: "조금 비싸더라도 멋진 수영장이나 스파가 있는 리조트.", type: 'E' },
      { text: "위치 좋고 깔끔하면 OK! 잠만 잘 건데 뭐.", type: 'C' }
    ]
  },
  {
    id: 10,
    question: "여행을 마치고 돌아왔을 때, 가장 만족스러운 순간은?",
    options: [
      { text: "알찬 일정! 계획한 모든 것을 완벽하게 해냈을 때.", type: 'P' },
      { text: "예상치 못한 멋진 장소를 발견하고, 좋은 사람을 만났을 때.", type: 'J' }
    ]
  },
  {
    id: 11,
    question: "하루 일정을 마친 저녁 시간, 나의 선택은?",
    options: [
      { text: "숙소에서 편안하게 쉬면서 내일 계획을 점검한다.", type: 'R' },
      { text: "에너지가 남아돈다! 야시장에 가서 구경해야지!", type: 'A' }
    ]
  },
  {
    id: 12,
    question: "나에게 '여행'이란?",
    options: [
      { text: "유명한 장소의 인증샷을 남기고 오는 것!", type: 'S' },
      { text: "나만의 장소를 지도에 추가하고 오는 것!", type: 'U' }
    ]
  }
];

const results = {
  ASCP: {
    title: "완벽주의 미식 탐험가",
    description: "정해진 예산과 시간 속에서 최고의 맛집과 명소를 공략하는 당신! 당신의 계획표는 곧 미슐랭 가이드입니다.",
    recommended: [
      { place: "전남 보성군 대한다원", reason: "넓은 차밭을 코스로 쪼개 동선 계획하기 좋아요. 입장·주차 등 비용 대비 만족도가 높아 미식·관광 루트를 효율적으로 짤 수 있습니다." },
      { place: "경북 청송군 산소카페청송정원", reason: "테마별 정원이 구역화되어 있어 시간표대로 보기 좋고, 사진·산책·근처 맛집까지 알뜰하게 묶기 편합니다." },
      { place: "전북 순창군 순창전통고추장민속마을", reason: "전통 장 체험과 시장 동선을 한 번에 설계 가능—가성비 미식 경험을 계획적으로 챙기기에 최적입니다." }
    ]
  },
  ASCJ: {
    title: "가성비 맛집 유튜버",
    description: "계획 없이 떠나지만, 동물적인 감각으로 가성비 맛집을 찾아내는 당신! 여행 후엔 'n만원으로 떠나는 혜자여행' 브이로그 한 편이 뚝딱 나옵니다.",
    recommended: [
      { place: "강원도 정선군 정선레일바이크", reason: "예약만 해두면 즉흥 코스 확장 가능! 탑승 전후로 시장·스카이워크 연결해 소액으로도 꽉 찬 경험을 만들 수 있어요." },
      { place: "충북 단양군 단양강잔도", reason: "입장 부담이 적고 경치가 즉흥 산책에 딱. 포토스팟이 이어져 SNS 업로드도 가볍게 해결됩니다." },
      { place: "전남 진도군 진도신비의바닷길", reason: "조수 간만에 맞춰 뜨는 길—계획은 최소, 타이밍만 맞추면 되는 ‘가성비 극대화’의 즉흥 스팟입니다." }
    ]
  },
  ASEP: {
    title: "FLEX한 인플루언서",
    description: "돈보다는 경험! SNS에서 가장 핫한 곳이라면 어디든 달려가는 당신. 최고의 사진 한 컷을 위해 지갑 여는 것을 망설이지 않습니다.",
    recommended: [
      { place: "강원도 정선군 하이원리조트스키장", reason: "장비·리프트 등 지출이 있지만 ‘리프트 타임표’대로 동선을 짜서 최고의 라이딩 경험을 확보할 수 있습니다." },
      { place: "충북 단양군 단양패러글라이딩", reason: "비용을 투자해도 ‘하늘 위 한 컷’의 경험 값이 남습니다. 풍향 체크와 예약 등 계획형 성향과도 궁합이 좋아요." },
      { place: "전남 고흥군 나로우주센터우주과학관", reason: "우주·과학 체험을 일정표에 맞춰 촘촘히 즐길 수 있는 하이-익스피리언스 코스입니다." }
    ]
  },
  ASEJ: {
    title: "즉흥적인 핫플 탐험가",
    description: "계획은 없지만 감은 최고! 지금 가장 핫한 곳이 어디인지 본능적으로 알고, 특별한 경험을 위해서라면 과감히 투자하는 트렌드세터입니다.",
    recommended: [
      { place: "전북 순창군 썬웨이어드벤처워터파크", reason: "즉흥으로도 즐길 액티비티가 가득—트래픽한 사진·영상 포인트가 많아 ‘핫플 감성’에 딱입니다." },
      { place: "강원도 영월군 별마로천문대", reason: "별 보기 좋은 날씨만 맞추면 끝! 밤하늘 콘텐츠로 강렬한 경험치를 쌓기 좋아요." },
      { place: "전남 진도군 진도개테마파크", reason: "특색 있는 체험으로 유니크한 피드 구성이 가능—즉흥 방문에도 ‘경험 값’이 확실합니다." }
    ]
  },
  AUCP: {
    title: "실속있는 오지 탐험가",
    description: "남들이 모르는 숨겨진 장소를 최소의 비용으로 탐험하는 계획적인 여행자. 당신의 여행 경로는 그 누구도 따라 할 수 없는 최고의 가성비 루트입니다.",
    recommended: [
      { place: "경북 영양군 영양자작나무숲", reason: "덜 알려진 숲길을 코스별로 계획해 조용히 걷기 좋고, 비용 부담 없이 깊은 자연을 누릴 수 있어요." },
      { place: "강원도 영월군 김삿갓계곡", reason: "주요 포인트를 체크해 두면 한적한 계류 산책이 가능—실속형 숨은 명소 루트에 잘 맞습니다." },
      { place: "전남 보성군 제암산자연휴양림", reason: "숙영·트레일을 미리 예약·계획해 두면 인파 없이 숲 힐링을 가성비 있게 즐길 수 있습니다." }
    ]
  },
  AUCJ: {
    title: "자유로운 방랑가",
    description: "단 하나의 목적지만 정해놓고, 최소한의 짐과 예산으로 떠나는 당신. 현지에서 부딪히며 얻는 정보로 길을 개척하는 진정한 모험가입니다.",
    recommended: [
      { place: "전남 고흥군 소록도", reason: "섬 자체가 잔잔한 산책로—표정 좋은 해변과 길을 즉흥적으로 골라 걷기 좋습니다." },
      { place: "경북 영덕군 옥계계곡", reason: "한적한 물가 포인트를 그때그때 골라 쉬기 좋은 숨은 계곡 스팟입니다." },
      { place: "강원도 화천군 딴산유원지", reason: "현지감으로 들렀다 쉬기 좋은 조용한 유원지—가벼운 즉흥 발걸음에 특화되어 있어요." }
    ]
  },
  AUEP: {
    title: "경험주의 개척가",
    description: "아무도 가보지 않은 곳에서 특별한 경험을 하는 것을 최고의 가치로 여기는 당신. 완벽한 계획 아래, 최고의 경험을 위해 과감히 투자합니다.",
    recommended: [
      { place: "강원도 영월군 고씨동굴", reason: "동굴 탐험 자체가 특별한 경험—입장/이동 동선을 세밀히 짜면 체력·시간을 효율적으로 씁니다." },
      { place: "충북 단양군 만천하스카이워크", reason: "유리 전망대와 짚와이어 등 고도 체험이 확실한 ‘하이-임팩트’ 코스. 대기·날씨 체크가 관건이라 계획형과 궁합 Good." },
      { place: "경북 청송군 주산지", reason: "물안개 포인트·시간대를 사전에 연구할수록 ‘인생샷’ 확률이 높아지는 플래너형 명소입니다." }
    ]
  },
  AUEJ: {
    title: "와일드 어드벤처러",
    description: "지도에 없는 곳, 와이파이가 터지지 않는 곳으로 떠나는 것을 즐기는 당신! 계획 없이 떠나 즉흥적으로 최고의 순간을 만들어내는 탐험가입니다.",
    recommended: [
      { place: "충북 단양군 단양패러글라이딩", reason: "날씨 맞으면 바로 GO! 즉흥 한 방으로 레벨이 올라가는 모험 체험입니다." },
      { place: "전북 장수군 장수논개수상레저", reason: "현장 상황에 맞춰 바로 즐기는 수상 액티비티—에너지형 성향과 잘 맞아요." },
      { place: "강원도 정선군 하이원워터월드", reason: "슬라이드·풀을 즉석에서 선택하며 놀기 좋은 대형 워터 시설입니다." }
    ]
  },
  RSCP: {
    title: "계획적인 힐링 여행자",
    description: "유명 관광지의 가장 조용한 시간을 공략하는 당신. 가성비 좋은 숙소에서, 완벽한 계획과 함께 여유로운 힐링을 즐기는 스마트한 여행자입니다.",
    recommended: [
      { place: "경북 청송군 송소고택", reason: "체크인/체크아웃 시간과 한옥 공간 동선을 계획적으로 즐기면 조용한 휴식의 밀도가 올라갑니다." },
      { place: "전남 보성군 대원사", reason: "사찰 산책로·차 향기와 함께 하는 힐링. 시간표대로 움직이면 더 여유로운 하루가 됩니다." },
      { place: "경북 영덕군 영덕해맞이공원", reason: "혼잡 시간을 피해 골든타임에 맞춰 방문하면 청량한 바다 전망을 한적하게 즐길 수 있어요." }
    ]
  },
  RSCJ: {
    title: "느긋한 동네 산책가",
    description: "유명 관광지 근처, 한적한 동네를 어슬렁거리다 가성비 좋은 로컬 맛집을 발견하는 소소한 행복을 즐기는 당신. 계획 없는 여유를 사랑합니다.",
    recommended: [
      { place: "전남 보성군 보성비봉공룡공원", reason: "큰 비용 없이도 산책·전망·포토를 가볍게 즐기는 동네형 쉼터 감성." },
      { place: "강원도 화천군 붕어섬유원지", reason: "조용한 물가를 그날의 기분 따라 걷고 쉬기 좋은 ‘느긋 산책’ 스팟." },
      { place: "경남 의령군 정암루", reason: "한옥 누정에서 강바람을 맞으며 멍 때리기 좋은 즉흥 힐링 포인트입니다." }
    ]
  },
  RSEP: {
    title: "럭셔리 호캉스러",
    description: "최고의 휴식은 곧 최고의 경험! 완벽한 계획 아래, 전망 좋은 호텔과 고급 스파를 즐기며 재충전하는 당신. 휴식을 위해서라면 투자는 아깝지 않습니다.",
    recommended: [
      { place: "강원도 정선군 하이원스노우월드", reason: "리조트형 휴식과 액티비티를 계획적으로 결합—스파·온천과 묶으면 ‘프리미엄 휴식’ 완성." },
      { place: "전북 순창군 강천힐링스파", reason: "시설 예약과 코스 관리로 온전히 자신을 돌보는 데 집중할 수 있어요." },
      { place: "경북 청송군 소노벨청송솔샘온천", reason: "온천·휴식 위주의 일정 구성에 최적—컨디션 회복을 위한 투자형 선택지입니다." }
    ]
  },
  RSEJ: {
    title: "감성적인 미식가",
    description: "계획 없이 떠나지만, 감각적인 인테리어의 레스토랑과 분위기 좋은 카페를 찾아내어 여유를 즐기는 당신. 당신의 발길이 닿는 곳이 곧 핫플레이스입니다.",
    recommended: [
      { place: "전남 진도군 세방낙조전망대", reason: "감성 한 컷을 위한 황금빛 노을—시간만 맞추면 되는 즉흥 힐링 포인트." },
      { place: "전남 보성군 한국차박물관", reason: "차 향과 전시를 느긋하게—날씨 따라 카페·다원 산책으로 코스 확장하기 좋습니다." },
      { place: "강원도 영월군 청령포", reason: "물돌이 풍경과 고요한 숲길이 주는 여백—즉흥적으로 들러도 만족도가 높아요." }
    ]
  },
  RUCP: {
    title: "효율적인 자연인",
    description: "사람 없는 조용한 자연 속에서 최소한의 비용으로 완벽한 힐링을 계획하는 당신. 최고의 캠핑 장소를 찾아내어 유유자적 시간을 보냅니다.",
    recommended: [
      { place: "경남 의령군 자굴산자연휴양림", reason: "데크·트레일을 미리 예약해 조용한 숲캠프를 효율적으로 즐기기 좋습니다." },
      { place: "전북 순창군 회문산자연휴양림", reason: "사람 적은 숲길 위주로 동선을 짜면 ‘조용한 휴식’의 본질을 챙길 수 있어요." },
      { place: "경북 영양군 흥림산자연휴양림", reason: "가성비 숙영과 한적한 산책로—효율을 중시하는 자연인에게 딱 맞습니다." }
    ]
  },
  RUCJ: {
    title: "숨은 명소 콜렉터",
    description: "지도에도 없는 작은 절, 이름 모를 해변을 찾아내어 온전히 그 공간을 즐기는 당신. 계획 없는 발걸음이 최고의 힐링을 선물한다고 믿습니다.",
    recommended: [
      { place: "경북 영덕군 하저리해수욕장", reason: "크게 붐비지 않는 소해변—그날의 기분에 따라 파도·산책을 즉흥 선택." },
      { place: "전남 고흥군 연소해수욕장", reason: "차분한 바다와 모래사장을 가볍게 즐기기 좋은 숨은 바다 스팟." },
      { place: "전북 임실군 붕어섬생태공원", reason: "도시 소음에서 벗어나 바람 쐬며 산책하기 좋은 잔잔 명소입니다." }
    ]
  },
  RUEP: {
    title: "평화로운 경험주의자",
    description: "조용한 곳에서 특별한 경험을 하는 것을 최고의 가치로 여기는 당신. 명상, 요가 리트릿, 템플 스테이 등 완벽한 계획 아래 몸과 마음을 재충전합니다.",
    recommended: [
      { place: "충북 단양군 구인사", reason: "템플스테이·명상 등 루틴형 휴식 코스를 계획적으로 구성하기 좋은 사찰." },
      { place: "전북 순창군 강천사", reason: "고요한 숲길과 사찰 산책로—마음챙김 일정에 최적입니다." },
      { place: "전남 보성군 대원사", reason: "차분한 수행의 분위기 속에서 컨디션을 되찾는 ‘리트릿형’ 선택지." }
    ]
  },
  RUEJ: {
    title: "자유로운 영혼의 예술가",
    description: "사람 없는 곳이라면 어디든 OK! 즉흥적으로 떠나 조용한 자연 속에서 영감을 얻는 당신. 계획 없는 고독 속에서 진정한 자유를 느낍니다.",
    recommended: [
      { place: "강원도 화천군 조경철천문대", reason: "도시 불빛에서 멀리 떨어진 별 보기 명소—즉흥 별구경의 낭만." },
      { place: "경북 영양군 선바위관광지", reason: "자연 암봉과 강변 풍경이 주는 고요—영감 충전용 한적 스팟." },
      { place: "전남 진도군 운림산방", reason: "화가 허련의 자취가 남은 예술 공간—고즈넉한 즉흥 영감 여행에 잘 맞습니다." }
    ]
  }
};

function MbtiDataUploader() {
  const [uploading, setUploading] = useState(false);
  const [message, setMessage] = useState('');

  const handleUpload = async () => {
    if (uploading) return;
    
    if (!window.confirm("MBTI 데이터를 Firebase에 업로드하시겠습니까?")) {
      return;
    }

    setUploading(true);
    setMessage('업로드 중...');
    
    const batch = writeBatch(db);

    try {
      // 1. 질문 업로드 (컬렉션: mbtiQuestions)
      // 질문은 ID가 1, 2, 3, 4로 고정되어 있으므로 문서 ID를 'q1', 'q2' 등으로 지정
      questions.forEach((q) => {
        const docRef = doc(db, 'mbtiQuestions', `q${q.id}`);
        batch.set(docRef, q);
      });

      // 2. 결과 업로드 (컬렉션: mbtiResults)
      // 문서 ID를 MBTI 타입(예: 'ASCP')으로 지정하여 나중에 쉽게 찾도록 함
      Object.keys(results).forEach((key) => {
        const docRef = doc(db, 'mbtiResults', key);
        batch.set(docRef, results[key]);
      });

      await batch.commit();
      
      setMessage('업로드 완료!');
      alert('MBTI 질문/결과 데이터 업로드 완료!');

    } catch (error) {
      console.error("업로드 실패:", error);
      setMessage(`업로드 실패: ${error.message}`);
    } finally {
      setUploading(false);
    }
  };

  return (
    <div style={{ padding: '1rem', backgroundColor: '#e6f7ff', border: '1px solid #91d5ff', textAlign: 'center', marginBottom: '1rem' }}>
      <h4>(임시) MBTI 데이터 업로더</h4>
      <button onClick={handleUpload} disabled={uploading} style={{ padding: '0.5rem 1rem', cursor: 'pointer' }}>
        {uploading ? '처리 중...' : 'MBTI 데이터 업로드'}
      </button>
      <p>{message}</p>
    </div>
  );
}

export default MbtiDataUploader;